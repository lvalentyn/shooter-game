(()=>{"use strict";window.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("canvas1"),i=t.getContext("2d");t.width=window.innerWidth,t.height=window.innerHeight;const e=document.getElementById("collisionCanvas"),s=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;let h=0,a=!1;i.font="50px Impact";let r=0,o=0,n=[];class d{constructor(){this.spriteWidth=271,this.spriteHeight=194,this.sizeModifier=.6*Math.random()+.4,this.width=this.spriteWidth*this.sizeModifier,this.height=this.spriteHeight*this.sizeModifier,this.x=t.width,this.y=Math.random()*(t.height-this.height),this.directionX=5*Math.random()+3,this.directionY=5*Math.random()-2.5,this.markedForDeletion=!1,this.image=new Image,this.image.src="../files/raven.png",this.frame=0,this.maxFrame=4,this.timeSinceFlap=0,this.flapInterval=50*Math.random()+50,this.randomColors=[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())],this.color="rgb("+this.randomColors[0]+","+this.randomColors[1]+","+this.randomColors[2]+")",this.hasTrail=Math.random()>.5}update(i){if((this.y<0||this.y>t.height-this.height)&&(this.directionY*=-1),this.x-=this.directionX,this.y+=this.directionY,this.x<0-this.width&&(this.markedForDeletion=!0),this.timeSinceFlap+=i,this.timeSinceFlap>this.flapInterval&&(this.frame>this.maxFrame?this.frame=0:this.frame++,this.timeSinceFlap=0,this.hasTrail))for(let t=0;t<5;t++)c.push(new f(this.x,this.y,this.width,this.color));this.x<0-this.width&&(a=!0)}draw(){s.fillStyle=this.color,s.fillRect(this.x,this.y,this.width,this.height),i.drawImage(this.image,this.frame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}}let l=[];class m{constructor(t,i,e){this.image=new Image,this.image.src="../files/boom.png",this.spriteWidth=200,this.spriteHeight=179,this.size=e,this.x=t,this.y=i,this.frame=0,this.sound=new Audio,this.sound.src="../files/sound.wav",this.timeSinceLastFrame=0,this.frameInterval=200,this.markedForDeletion=!1}update(t){0===this.frame&&this.sound.play(),this.timeSinceLastFrame+=t,this.timeSinceLastFrame>this.frameInterval&&(this.frame++,this.timeSinceLastFrame=0,this.frame>5&&(this.markedForDeletion=!0))}draw(){i.drawImage(this.image,this.frame*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y-this.size/4,this.size,this.size)}}let c=[];class f{constructor(t,i,e,s){this.size=e,this.x=t+this.size/2+50*Math.random()-25,this.y=i+this.size/3+50*Math.random()-25,this.radius=Math.random()*this.size/10,this.maxRadius=20*Math.random()+35,this.markedForDeletion=!1,this.speedX=1*Math.random()+.5,this.color=s}update(){this.x+=this.speedX,this.radius+=.3,this.radius>this.maxRadius-5&&(this.markedForDeletion=!0)}draw(){i.save(),i.globalAlpha=1-this.radius/this.maxRadius,i.beginPath(),i.fillStyle=this.color,i.arc(this.x,this.y,this.radius,0,2*Math.PI),i.fill(),i.restore()}}window.addEventListener("click",(function(t){const i=s.getImageData(t.x,t.y,1,1).data;n.forEach((t=>{t.randomColors[0]!==i[0]&&t.randomColors[1]!==i[1]&&t.randomColors[2]!==i[2]||(t.markedForDeletion=!0,h++,l.push(new m(t.x,t.y,t.width)))}))})),function e(m=0){i.clearRect(0,0,t.width,t.height),s.clearRect(0,0,t.width,t.height);let f=m-o;o=m,r+=f,r>500&&(n.push(new d),r=0,n.sort((function(t,i){return t.width-i.width}))),i.fillStyle="black",i.fillText("Score: "+h,55,80),i.fillStyle="white",i.fillText("Score: "+h,50,75),[...c,...n,...l].forEach((t=>t.update(f))),[...c,...n,...l].forEach((t=>t.draw())),n=n.filter((t=>!t.markedForDeletion)),l=l.filter((t=>!t.markedForDeletion)),c=c.filter((t=>!t.markedForDeletion)),a?(i.textAlign="center",i.fillStyle="black",i.fillText("GAME OVER, Your score is "+h,t.width/2+5,t.height/2+5),i.textAlign="center",i.fillStyle="white",i.fillText("GAME OVER, Your score is "+h,t.width/2,t.height/2)):requestAnimationFrame(e)}(),function(t){let i=new Image;i.onload=i.onerror=function(){!function(t){let i=!0===t?"webp":"no-webp";document.documentElement.classList.add(i)}(2==i.height)},i.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}()}))})();